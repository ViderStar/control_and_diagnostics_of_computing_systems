# ЛР №7: FAR и OCRT (управляемые тесты)

## Введение

В управляемом вероятностном тестировании очередной набор выбирается так, чтобы быть «как можно дальше» от уже сгенерированных наборов. В этой лабораторной рассматриваются два конструктивных подхода:

- **FAR** (Fast Antirandom): быстрое анти‑вероятностное тестирование через центроид.
- **OCRT** (Optimal Controlled Random Test): оптимальный управляемый тест, который достигает максимально возможных расстояний при минимальной вычислительной сложности (конструктивно).

## Часть 1: FAR (centroid pattern)

### Идея

Предыдущие наборы $T_0..T_{i-1}$ рассматриваются как матрица $i \times N$. Для каждого бита считается среднее значение (центроид), затем оно округляется в 0/1 и инвертируется — это и есть новый набор.

### Центроид

Для позиции $l$:

$$ c_l = \frac{1}{i} \sum_{k=0}^{i-1} t_{k,l} $$

Получаем вектор $C = (c_{N-1}, \dots, c_0)$, где $c_l \in [0, 1]$.

### Бинаризация и инверсия

- если $c_l < 0.5 \Rightarrow c_l^{bin} = 0$
- если $c_l > 0.5 \Rightarrow c_l^{bin} = 1$
- если $c_l = 0.5$ — округление 0/1 равновероятно

Новый набор:

$$ T_i = \overline{C^{bin}} $$

### Параметры задания

- $N = 7$
- $q = 5$

## Часть 2: OCRT (для $N = 2^m$)

### Идея

Для $N = 2^m$ можно построить тест длины $q = 2(m+1)$, используя матрицу масок $M$. Например, для $N=4$ ($m=2$) матрица $M$ выглядит так:

$$
M = \begin{pmatrix}
0 & 0 & 0 & 0 \\
1 & 1 & 1 & 1 \\
0 & 0 & 1 & 1 \\
1 & 1 & 0 & 0 \\
0 & 1 & 0 & 1 \\
1 & 0 & 1 & 0
\end{pmatrix}
$$

### Формирование теста

1. $T_0$ — случайный двоичный вектор.
2. Каждый последующий $T_i = T_0 \oplus M_i^*$, где $M_i^*$ — строка матрицы масок после случайной перестановки столбцов.

Такой подход гарантирует максимально возможные суммарные расстояния между наборами.

### Параметры задания

- $N = 8$ ($m=3$)
- $q = 2(3+1) = 8$

## Оценка эффективности на схеме ЛР1–2

Как и в ЛР6, эффективность сравнивается через **процент покрытия** stuck-at неисправностей.

## Как запускается в этом проекте

- Генерация FAR + OCRT и вывод покрытия: `python3 main.py --suite prob`
- Реализация FAR/OCRT: `lab7/runner.py`
- Подсчёт покрытия: `helpers/fault_sim.py`

## Связь с другими лабораторными

- **ЛР1–2**: схема и множество stuck-at неисправностей.
- **ЛР6**: управляемые тесты через выбор лучшего кандидата.
- **ЛР7**: конструктивные (быстрые) методы формирования управляемых тестов без перебора.
